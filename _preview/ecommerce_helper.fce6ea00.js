import{u as P,T as o,j as i,w as b}from"./constants.8e39bf94.js";const S=(e,r,a,s,t)=>{let n=[];return a&&(a==null||a.map(l=>{if(l.selectedPrice._id===r.selectedPrice._id)if(e==="sub"){if(l.quantity===1||t===0)return;l.quantity=t||l.quantity-1}else l.quantity=t||l.quantity+1;n.push(l)})),b(`cart_details_${s}`,JSON.stringify({products:n})),n},g=e=>{if(!e.length)return 0;let r=0;return e.forEach(a=>{r+=O(a)*a.quantity}),r},w=e=>(e==null?void 0:e.availableQuantity)<=0&&e.trackInventory&&!e.allowOutOfStockPurchases,k=async e=>{const r=P();try{const{data:a}=await o.getAllCollectionsByLocation({altId:r.value.locationId,altType:"location",collectionIds:e.join()});return a}catch(a){return console.log("Error caught: ",a.message),{error:a}}},m=(e,r)=>{var a;return(a=e==null?void 0:e.medias)==null?void 0:a.find(s=>{var t;return(t=s==null?void 0:s.priceIds)==null?void 0:t.includes(r)})},D=e=>e.filter(r=>r.selectedPrice.type==="recurring").length>1,O=e=>{let r=e.selectedPrice.amount;return e.selectedPrice.trialPeriod&&(r=0),r+(e.selectedPrice.setupFee??0)},A=async(e,r)=>{let a=e==null?void 0:e.map(t=>{var n;return(n=t==null?void 0:t.selectedPrice)==null?void 0:n._id}).join(",");const s=await o.getSelectedProductPrices({locationId:r,ids:a});return e==null||e.map(t=>{const n=s.find(l=>l._id===t.selectedPrice._id);return t.quantity>n.availableQuantity&&n.trackInventory&&!n.allowOutOfStockPurchases?(t.status=`Only ${n.availableQuantity} items are available in stock`,t.isDeleted=!0,t):n?(t.status="",t.isDeleted=!1,t.name=n.product.name,t.selectedProductImage=t.selectedProductImage??n.product.image,t.selectedPrice.name=n.name,t.selectedPrice.amount=n.amount,t.selectedPrice.currency=n.currency,t):(t.status="W're sorry! This item is not available at the moment",t.isDeleted=!0,t)}),e},_=e=>e.map(a=>a.isDeleted).includes(!0),T=e=>`${((e.compareAtPrice-e.amount)*100/e.compareAtPrice).toFixed(0)}% off`,j=async(e,r,a,s,t,n,l,u,f,d)=>{const h=P(),c={limit:e,offset:r,locationId:h.value.locationId,collectionSlug:a};s&&(c.q=encodeURIComponent(s)),t&&(c.advancedSearch=t),n&&(c.availability=n),l&&(c.minPrice=l),u&&(c.maxPrice=u),f&&(c.sortField=f),d&&(c.sortOrder=d);try{return await o.getStoreProducts(c)}catch(y){console.error("Error while fetching products: ",y)}},L=e=>{var r,a,s,t,n;if(e.isLabelEnabled&&((r=e.label)!=null&&r.title)){let l=!0;return(a=e.label)!=null&&a.startDate&&(l=i().isAfter(i((s=e.label)==null?void 0:s.startDate))),(t=e.label)!=null&&t.endDate&&(l=l&&i().isBefore(i((n=e.label)==null?void 0:n.endDate))),l}};export{T as a,O as b,A as c,w as d,m as e,j as f,k as g,D as h,_ as i,g as j,L as s,S as u};
