import{d as Nt,r as p,c as Ae,o as Mt,a as h,b as w,f as E,n as et,e as M,i as O,t as Z,m as ce,l as de,w as tt,v as at,Q as At,h as rt,F as Dt,q as ne,s as oe,A as re,x as Ut,j as Ft}from"./entry.819ce933.js";import{u as $t,b as Vt,m as De,c as Bt,f as zt,h as qt,w as nt,T as J,U as me,V as ve,W as pe,a4 as be,a5 as Ht,a6 as Jt}from"./constants.8e39bf94.js";import{b as T,E as ye,c as Wt}from"./index.b716f3c9.js";import{t as Gt,f as jt}from"./funnel_event_helper.3fa06503.js";import{F as ot}from"./FunnelServices.4c5adf48.js";import{h as Kt,f as Zt,g as Qt,a as Xt,c as Yt}from"./orderform_helpers.429a6040.js";import{u as ea}from"./useRedirectAction.8ea1ef8d.js";import{p as ta}from"./payment-warning.62509b89.js";import{P as C,C as st,s as Ue,S as aa,b as lt,N as it,A as ut}from"./HLConst.18ce99b8.js";import{_ as ra}from"./MoonLoader.vue.151c5415.js";import"./HLImage.vue.177d8bb8.js";import"./client-only.023003d0.js";import"./HtmlPreview.vue.e838f505.js";import"./utils.1236acbf.js";import"./index.f1fa0ff4.js";import"./am_helper.8deee046.js";import"./currency_helper.0e2fcc1c.js";var $e={};Object.defineProperty($e,"__esModule",{value:!0});function Ie(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Ie=function(r){return typeof r}:Ie=function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},Ie(n)}var mt="https://js.stripe.com/v3",na=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,ct="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",oa=function(){for(var r=document.querySelectorAll('script[src^="'.concat(mt,'"]')),a=0;a<r.length;a++){var y=r[a];if(na.test(y.src))return y}return null},sa=function(r){var a=r&&!r.advancedFraudSignals?"?advancedFraudSignals=false":"",y=document.createElement("script");y.src="".concat(mt).concat(a);var g=document.head||document.body;if(!g)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return g.appendChild(y),y},la=function(r,a){!r||!r._registerWrapper||r._registerWrapper({name:"stripe-js",version:"1.54.2",startTime:a})},Se=null,ia=function(r){return Se!==null||(Se=new Promise(function(a,y){if(typeof window>"u"||typeof document>"u"){a(null);return}if(window.Stripe&&r&&console.warn(ct),window.Stripe){a(window.Stripe);return}try{var g=oa();g&&r?console.warn(ct):g||(g=sa(r)),g.addEventListener("load",function(){window.Stripe?a(window.Stripe):y(new Error("Stripe.js not available"))}),g.addEventListener("error",function(){y(new Error("Failed to load Stripe.js"))})}catch(F){y(F);return}})),Se},ua=function(r,a,y){if(r===null)return null;var g=r.apply(void 0,a);return la(g,y),g},dt=function(r){var a=`invalid load parameters; expected object of shape

    {advancedFraudSignals: boolean}

but received

    `.concat(JSON.stringify(r),`
`);if(r===null||Ie(r)!=="object")throw new Error(a);if(Object.keys(r).length===1&&typeof r.advancedFraudSignals=="boolean")return r;throw new Error(a)},we,Fe=!1,vt=function(){for(var r=arguments.length,a=new Array(r),y=0;y<r;y++)a[y]=arguments[y];Fe=!0;var g=Date.now();return ia(we).then(function(F){return ua(F,a,g)})};vt.setLoadParameters=function(n){if(Fe&&we){var r=dt(n),a=Object.keys(r),y=a.reduce(function(g,F){var Q;return g&&n[F]===((Q=we)===null||Q===void 0?void 0:Q[F])},!0);if(y)return}if(Fe)throw new Error("You cannot change load parameters after calling loadStripe");we=dt(n)};$e.loadStripe=vt;var ca=$e;const da=ne(()=>oe(()=>import("./Recaptcha.db9c9195.js"),[],import.meta.url).then(n=>n.default||n)),ma=ne(()=>oe(()=>import("./PaymentElementComponent.d7009a3f.js"),["./ghl-payment-element.29b93162.css","./PaymentElementComponent.3a186e73.css"],import.meta.url).then(n=>n.default||n)),va=ne(()=>oe(()=>import("./NewPaypalSmartBtnSubscription.2b1bfe71.js"),["./PaymentElementComponent.3a186e73.css"],import.meta.url).then(n=>n.default||n)),pa=ne(()=>oe(()=>import("./NewPaypalSmartBtnOrder.3ec1da93.js"),["./PaymentElementComponent.3a186e73.css"],import.meta.url).then(n=>n.default||n)),ya=ne(()=>oe(()=>import("./NewPaypalSmartBtnBNPL.fe90ddc8.js"),["./PaymentElementComponent.3a186e73.css"],import.meta.url).then(n=>n.default||n)),fa=ne(()=>oe(()=>import("./PaymentElementModal.78f928be.js"),["./ghl-payment-element.29b93162.css","./PaymentElementModal.15636bd6.css"],import.meta.url).then(n=>n.default||n)),_a=["id","href","target","data-animation-class","aria-label"],ga={key:0,style:{"margin-right":"5px"},class:"button-icon-start"},ha={class:"main-heading-button"},Pa={key:1,style:{"margin-left":"5px"},class:"button-icon-end"},ba={class:"sub-heading-button"},Sa={key:1,class:"recaptcha-container button-recaptcha-container"},Ia={key:0},wa=["disabled","data-animation-class","id","aria-label"],Ea={key:0,class:"button-icon-start"},Oa={class:"main-heading-button"},Ta={key:1,class:"button-icon-end"},ka={class:"sub-heading-button"},xa={class:"btn-loader-position",style:{left:"50%",position:"absolute",top:"50%",transform:"translate(-50%, -50%)"}},Ra={key:0},La=["id"],Ca={key:0,class:"card-el-error-msg"},Na=["src"],Ma={key:3,style:{width:"70%",margin:"8px auto"},class:"paypal-content"},Aa={key:1},Da={key:4,class:"card-el-error-msg error-message",style:{"justify-content":"center"}},Ua={inheritAttrs:!1},tr=Nt({...Ua,__name:"Button",props:{element:{type:Object,required:!0},classStyles:{type:Array,required:!0}},setup(n){var Ge,je,Ke,Ze,Qe,Xe,Ye;const r=n,a=$t(),{openPopup:y}=Wt(),g=Vt(r.element),{call:F,createMembershipToken:Q,mailTo:pt,sms:yt,goToNextFunnelStep:se,openUrl:Ee,getNextFunnelStepURL:ft,goToStep:_t}=ea(),gt=Ft(),{$bus:Ve}=gt;let X=(je=(Ge=r.element.extra)==null?void 0:Ge.text)==null?void 0:je.value;X=De(X);let Y=(Ze=(Ke=r.element.extra)==null?void 0:Ke.subText)==null?void 0:Ze.value;Y=De(Y);const ht=a.value.funnelId,Pt=a.value.stepId,bt=a.value.funnelPageId,f=a.value.locationId,N=(Ye=(Xe=(Qe=r.element.extra)==null?void 0:Qe.productId)==null?void 0:Xe.value)==null?void 0:Ye.id,_=p(!1),fe=p(!1),Oe=p(""),Be=p(""),$=p(),Te=p(!1),ke=p(""),V=p(""),W=p(""),P=p(!1),St=Ae(()=>{var e;return((e=$.value)==null?void 0:e.price.type)==="recurring"}),m=p(),b=p(""),le=p(!1),B=p(),ie=p(""),ze=p(!1),A=p(!0),G=p(),qe=p(),ee=p({mode:"payment",amount:0,currency:"",contact:{id:"",full_name:"",email:"",phone:""}}),_e=p();p(!1);const z=p({mode:"payment",amount:0,currency:"usd",enableBNPL:!0}),xe=p(!1),{action:{value:j},visitWebsite:{value:D}}=r.element.extra,q=Ae(()=>{var e;return((e=a.value.paymentProviderDetails)==null?void 0:e.provider)===C.CUSTOM_PROVIDER&&!!a.value.customProviderPublishableKey&&j===T.SELL_PRODUCT}),It=async e=>{e.type==="ready"?(A.value=!1,G.value="",_.value=!1):e.type==="processing"?(P.value=!0,G.value=""):e.type==="error"?(e.message==="Request failed with status code 429"?(B.value=void 0,le.value=!0):G.value=e.message,P.value=!1,A.value=!1):e.type==="success"&&(G.value="",P.value=!1,await wt(e))},wt=async e=>{try{let t=localStorage.getItem("_ud");t&&(t=JSON.parse(t));const{paymentResponseData:i}=await Kt(t,e.data,e.provider,f);await ue(i)}catch(t){G.value=t}finally{sessionStorage.removeItem("orderResponse"),sessionStorage.removeItem("contactResponse")}},He=()=>{const e=(X??"")+" "+(Y??"");if(X||Y)return e;if(j===T.GO_TO_URL){const{visitWebsite:{value:t}}=r.element.extra;return t==null?void 0:t.url}return e},Et=e=>{if(!e){ie.value="Verification failed! Please try again";return}ie.value="",B.value=e},Je=[T.CLICK_TO_CALL,T.CLICK_TO_SMS,T.GO_TO_URL,T.GO_TO_STEP];Je.includes(j)&&(fe.value=!0,Bt(D==null?void 0:D.url)||(Oe.value=We())),Mt(()=>{Je.includes(j)&&(fe.value=!0,Oe.value=We()),a.value.orderFormVersion===2&&N&&j===T.SELL_PRODUCT&&(Ot(),_e.value=JSON.parse(localStorage.getItem("_ud")||"{}").country)});async function Ot(){var e,t,i,c,d,s,o;try{const v=await ot.findProductById({productId:N});$.value={...v,qty:1,amount:v.price.amount},V.value=(e=v==null?void 0:v.price)==null?void 0:e.currency,ee.value.amount=$.value.amount,ee.value.currency=V.value,ee.value.mode=((t=$.value)==null?void 0:t.price.type)==="recurring"?"subscription":"payment",ee.value.productDetails=[{productId:(i=v==null?void 0:v.product)==null?void 0:i._id,priceId:(c=v==null?void 0:v.price)==null?void 0:c._id}],z.value.amount=$.value.amount,z.value.currency=V.value.toLowerCase(),z.value.mode=((d=$.value)==null?void 0:d.price.type)==="recurring"?"subscription":"payment";let l=localStorage.getItem("_ud");l&&(l=JSON.parse(l),ee.value.contact={id:l==null?void 0:l.id,full_name:l==null?void 0:l.full_name,email:l==null?void 0:l.email,phone:l==null?void 0:l.phone}),setTimeout(()=>{ze.value=!0},1e3)}catch(v){const l=((o=(s=v==null?void 0:v.response)==null?void 0:s.data)==null?void 0:o.message)||(v==null?void 0:v.message)||"Not able to fetch products!";console.error(l),alert("Not able to fetch products!")}}async function Tt(){var t,i,c,d,s,o,v,l,S,U,K,k,x,L;const{action:e}=r.element.extra;switch(e.value){case"openPopup":{Gt(a.value.stepId),y();break}case"url":{const{visitWebsite:u}=r.element.extra;Ee(u.value);break}case"hide-element":{const{hideElements:u}=r.element.extra;qt(u.value);break}case"show-element":{const{showElements:u}=r.element.extra;zt(u.value);break}case"scroll-to-element":{const{scrollToElement:u}=r.element.extra;Ve.$emit("scroll-to-element",u.value);break}case"go-to-next-funnel-step":{_.value=!0,se();break}case T.GO_TO_STEP:{_.value=!0,se(r.element.extra.stepPath.value);break}case"sell-product":{if(_.value)return;_.value=!0;const u=`_pl_${a.value.funnelId}`,R=localStorage.getItem(u);let I;if(R&&(I=JSON.parse(R)),a.value.orderFormVersion===2){if(re("provider").value===C.CUSTOM_PROVIDER&&(I!=null&&I.manualPaymentMethodId)){he(st,I==null?void 0:I.manualPaymentMethodId);return}if(re("provider").value==="pp")Te.value=!0;else{if((((i=(t=a.value)==null?void 0:t.paymentProviderDetails)==null?void 0:i.provider)===C.AUTHORIZE_NET||((d=(c=a.value)==null?void 0:c.paymentProviderDetails)==null?void 0:d.provider)===C.WHITE_LABEL&&((o=(s=a.value)==null?void 0:s.paymentProviderDetails)==null?void 0:o.whiteLabelProvider)===C.AUTHORIZE_NET)&&a.value.merchantLoginId){he(ut);return}else if((((l=(v=a.value)==null?void 0:v.paymentProviderDetails)==null?void 0:l.provider)===C.NMI||((U=(S=a.value)==null?void 0:S.paymentProviderDetails)==null?void 0:U.provider)===C.WHITE_LABEL&&((k=(K=a.value)==null?void 0:K.paymentProviderDetails)==null?void 0:k.whiteLabelProvider)===C.NMI)&&a.value.nmiMerchantGatewayId){he(it);return}else if(((L=(x=a.value)==null?void 0:x.paymentProviderDetails)==null?void 0:L.provider)===C.SQUARE&&a.value.squareMerchantGatewayId){he(lt);return}else if(q.value){await Ct(C.CUSTOM_PROVIDER);return}const te=a.value.stripePublishableKey,Ne=a.value.stripeAccountId,Me=a.value.stripePublishableKey;if(te&&Me)ke.value=await ca.loadStripe(te,{stripeAccount:Ne||void 0});else{alert("Stripe account not found!");return}kt()}}else xt();break}case"click-to-call":{const u=r.element.extra;F(u[ye.PHONE_NUMBER].value);break}case"click-to-sms":{const u=r.element.extra;yt(u[ye.PHONE_NUMBER].value);break}case"click-to-mail":{const u=r.element.extra;pt(u[ye.EMAIL_ADDRESS].value);break}case T.GO_TO_MEMBERSHIP:{try{let u;const R=a.value.locationId,{ct:I,previewUrl:H}=re(`_mf_${R}`).value;location.hostname==="localhost"?u=`http://localhost:4040/library/?domain=${H}&token=${I}&location_id=${R}`:u=`${H}/library?&token=${I}&location_id=${R}`,Ee({url:u,newTab:!1})}catch{alert("Sorry something went wrong.")}break}default:console.error(`Invalid action type received: ${e.value}`)}}function ue(e){var t,i,c,d,s,o,v;try{const l=e==null?void 0:e.membershipPurchase;l!=null&&l.length&&Q(f,l[0].token);const S=e==null?void 0:e.membershipToken;S&&Q(f,S),Ut(()=>{jt("track","Upsell")});const{saleAction:U,stepPath:K,visitWebsite:k}=r.element.extra;if(!U)if(a.value.funnelNextStep){se();return}else throw new Error("Redirect not handled");if(a.value.orderFormVersion===2){const x=`_pl_${a.value.funnelId}`,L=localStorage.getItem(x);if(L){let u=JSON.parse(L);u.products.push($.value),u.total+=(i=(t=m.value)==null?void 0:t.order)==null?void 0:i.amount,u.tax=(s=(d=(c=m.value)==null?void 0:c.order)==null?void 0:d.taxSummary)==null?void 0:s.map(R=>{var H;const I=(H=u==null?void 0:u.tax)==null?void 0:H.find(te=>te._id===R._id);return I?{...I,amount:I.amount+R.amount}:R}),nt(x,JSON.stringify(u))}}else{const x=`_pl_v1_${a.value.funnelId}`,L=localStorage.getItem(x);if(L){let u=JSON.parse(L);u.push((v=(o=r==null?void 0:r.element.extra)==null?void 0:o.productId)==null?void 0:v.value),nt(x,JSON.stringify(u))}}switch(U.value){case"url":if(k&&k.value&&k.value.url){Ee(k.value);break}else throw new Error("Redirect not handled");case"step-path":if(K&&K.value){se(K.value);break}else throw new Error("Redirect not handled");default:if(a.value.funnelNextStep){se();break}else throw new Error("Redirect not handled")}}catch{{const S=JSON.parse(localStorage.getItem("_ud")||"{}"),U=Ue.includes(localStorage.getItem(`pmt_${a.value.funnelId}_${S==null?void 0:S.id}`)||"")?"We are proccessing your order with the bank. We'll confirm you order after bank's confirmation.":`Order successfully placed! 
 However, Something went wrong while displaying this webpage, please contact the seller.`;alert(U)}_.value=!1;return}}const ge=async()=>{var c,d;a.value.countryList.length===0&&await Qt();const e=Ae(()=>{var s;return((s=Xt(_e==null?void 0:_e.value))==null?void 0:s.states.map(o=>({iso:o.code,name:o.name})))??[]});let t=localStorage.getItem("_ud");t&&(t=JSON.parse(t),sessionStorage.setItem("contactResponse",JSON.stringify(t)));const i=t==null?void 0:t.customer_id;if(!i){b.value="Contact not found!";return}if(le.value&&!B.value){ie.value="Invalid Captcha!",P.value=!1,_.value=!1;return}if(m.value=await Yt({contactId:i,domain:a.value.domain,pageUrl:a.value.pageUrl,locationId:f,productPreviewList:[{_id:N,qty:1}],store:a.value,subType:Jt.UPSELL,traceId:t==null?void 0:t.traceId,reCaptchaToken:B.value,toZip:t.postal_code,toState:((c=e.value.find(s=>s.name===t.state))==null?void 0:c.iso)??"",toCountry:t.country}),B.value=void 0,(d=m.value)!=null&&d.error){m.value.status===429&&(le.value=!0),b.value=m.value.message??"Error creating order!",P.value=!1,_.value=!1;return}sessionStorage.setItem("orderResponse",JSON.stringify(m.value))};async function kt(){var e,t,i,c,d,s,o,v;try{if(!N)throw new Error("No product Id found for initiating stripe payment");if(b.value="",await ge(),z.value.amount=(t=(e=m.value)==null?void 0:e.order)==null?void 0:t.amount,z.value.currency=V.value.toLowerCase(),z.value.mode=((i=$.value)==null?void 0:i.price.type)==="recurring"?"subscription":"payment",(d=(c=m.value)==null?void 0:c.order)!=null&&d.amount||(z.value.mode="setup"),!m.value||(s=m.value)!=null&&s.error)return;let l={};l={altId:f,altType:"location",orderId:m.value.order._id,reCaptchaToken:B.value};const S=JSON.parse(localStorage.getItem("_ud")||"{}");Ue.includes(localStorage.getItem(`pmt_${a.value.funnelId}_${S==null?void 0:S.id}`)||"")&&(l.paymentMethodTypes=[aa.sepa]);const U=await Zt(f,(o=m.value.order)==null?void 0:o.contactId);if(!!["klarna","affirm","afterpay_clearpay"].includes(U)){xe.value=!0;return}const k=await J.initiateStripePayment(l);if(!k.success){b.value=k.message||"We're sorry, but something went wrong. Please try again.";return}const{clientSecret:x,paymentMethodId:L}=k;if(x){let ae={};if(Ue.includes(localStorage.getItem(`pmt_${a.value.funnelId}_${S==null?void 0:S.id}`)||"")?ae=await ke.value.confirmSepaDebitPayment(x,{payment_method:L}):ae=await ke.value.confirmCardPayment(x,{payment_method:L,setup_future_usage:"off_session"}),ae.error){console.error("Failed to confirm card payment!",ae.error),ae.error.message&&alert(ae.error.message);return}}const{orderId:u,paymentIntentId:R,subscriptionId:I,invoiceId:H,subId:te,txnId:Ne}=k,Me={altId:f,altType:"location",orderId:u,paymentIntentId:R,subscriptionId:I,invoiceId:H,isAuth:!1,subId:te,txnId:Ne,attribution:{eventData:me(),sessionId:ve(f),sessionFingerprint:pe(f)}},Pe=await J.verifyStripePayment(Me);if(console.log("verifyPaymentResponseData",Pe),!Pe.success){b.value=Pe.message||"We're sorry, but something went wrong. Please try again.";return}await ue(Pe)}catch(l){if(((v=l==null?void 0:l.response)==null?void 0:v.status)===429){le.value=!0,P.value=!1,_.value=!1;return}b.value=be(l),_.value=!1,console.error(l)}}async function he(e,t){var i,c,d;try{if(!N)throw new Error(`No product Id found for initiating ${e||"stripe"} payment`);if(P.value=!0,b.value="",await ge(),!m.value||(i=m.value)!=null&&i.error)return;let s;if((c=m.value)!=null&&c.order._id){s={altId:f,altType:"location",orderId:(d=m.value)==null?void 0:d.order._id,attribution:{eventData:me(),sessionId:ve(f),sessionFingerprint:pe(f)}};let o;switch(e){case ut:{o=await J.authorizeNetOrderPayment(s);break}case it:{o=await J.nmiOrderPayment(s);break}case st:{t&&(s.manualPaymentMethodId=t),o=await J.customProviderOrderPayment(s);break}case lt:{o=await J.squareOrderPayment({...s,saveCard:!1});break}default:console.log("Invalid payment provider");break}if(console.log(o),P.value=!1,!o.success){b.value=o.message||"We're sorry, but something went wrong. Please try again.";return}await ue({membershipPurchase:o.membershipPurchase,membershipToken:o.membershipToken})}}catch(s){_.value=!1,P.value=!1,console.log(s),b.value=be(s)}}async function xt(){if(N)try{const e=Ht(),t={...me(),fbEventId:e},i=ve(f),c=pe(f),d=await ot.funnelPayment({fingerprint:re("msgsndr_id").value,productList:[N],locationId:f,funnelId:ht,stepId:Pt,pageId:bt,domain:a.value.domain,pageUrl:a.value.pageUrl,source:"payment_button",submissionType:3,eventData:t,sessionId:i,sessionFingerprint:c,_mp:re("_mp").value});await ue(d)}catch(e){console.log(e)}finally{_.value=!0}}async function Re(e,t){var i,c;try{if(!N)throw new Error("No product Id found for initiating paypal payment");if(P.value=!0,W.value="",b.value="",await ge(),!m.value||(i=m.value)!=null&&i.error)return;const d={altId:f,altType:"location",orderId:(c=m.value)==null?void 0:c.order._id},s=await J.initiatePayPalPayment(d);if(!s.success){b.value=s.message||"We're sorry, but something went wrong. Please try again.";return}if(t.subscription&&s.plan_id)return t.subscription.create(s);if(t.order&&s.id)return s.id}catch(d){console.log(d.message),W.value=be(d),P.value=!1}}async function Le(e){try{if(!N)throw new Error("No product Id found for paypal payment");P.value=!0,W.value="",b.value="";const t={facilitatorAccessToken:e.facilitatorAccessToken,orderId:m.value.order._id,paypalOrderId:e.orderID,altId:f,altType:"location",attribution:{eventData:me(),sessionId:ve(f),sessionFingerprint:pe(f)}};e.payerID&&(t.paypalPayerId=e.payerID),e.subscriptionID&&(t.paypalSubscriptionId=e.subscriptionID);const i=await J.verifyPayPalPayment(t);if(console.log("verifyPaymentResponseData",i),!i.success){b.value=i.message||"We're sorry, but something went wrong. Please try again.";return}const c=re("provider");c.value="pp",await ue(i)}catch(t){console.error(t.message),W.value=be(t),P.value=!1}}function Ce(){P.value=!1,W.value="Transaction has been cancelled by the user!"}function We(){var t,i,c,d,s;let e="";switch(j){case T.CLICK_TO_CALL:{let o=(t=r.element.extra[ye.PHONE_NUMBER])==null?void 0:t.value;o=o==null?void 0:o.replace("tel:",""),e=`tel:${o}`;break}case T.CLICK_TO_SMS:{let o=(i=r.element.extra[ye.PHONE_NUMBER])==null?void 0:i.value;o=o==null?void 0:o.replace("sms:",""),e=`sms:${o}`;break}case T.GO_TO_URL:{e=D==null?void 0:D.url,e=De(e),e&&!e.startsWith("#")&&!/^https?:/.test(e)&&(e=`https://${e}`),Be.value=D!=null&&D.newTab?"_blank":"";break}case T.GO_TO_STEP:{const o=(s=(d=(c=r.element)==null?void 0:c.extra)==null?void 0:d.stepPath)==null?void 0:s.value;e=ft(o,!1);break}}return e}async function Rt(e){if(a.value.videoExistsInPage&&Ve.$emit("handle-redirect"),j===T.GO_TO_STEP){const t=r.element.extra.stepPath.value;_t(e,t)}}function Lt(){xe.value=!1,_.value=!1,A.value=!1}async function Ct(e){var i,c,d,s,o;if(!N)throw new Error("No product Id found for initiating stripe payment");if(b.value="",await ge(),!((c=(i=m.value)==null?void 0:i.order)!=null&&c._id&&e===C.CUSTOM_PROVIDER))return;const t={source:"order",sourceId:(s=(d=m==null?void 0:m.value)==null?void 0:d.order)==null?void 0:s._id,sourceDetails:m.value.order,traceId:m.value.traceId,extra:{attribution:{eventData:me(),sessionId:ve(f),sessionFingerprint:pe(f)}},captchaToken:B.value};(o=qe.value)==null||o.confirmPayment(t)}return(e,t)=>{const i=da,c=ma,d=va,s=pa,o=ya,v=fa;return h(),w(Dt,null,[fe.value?(h(),w("a",{key:0,id:`${n.element.id}_btn`,href:Oe.value,target:Be.value,"data-animation-class":E(g),class:et([n.classStyles,"text-center"]),onClick:t[0]||(t[0]=l=>Rt(l)),"aria-label":He()},[M("span",{style:ce(_.value?"visibility: hidden;":""),class:"main-heading-group"},[n.element.extra.icon!==""?(h(),w("span",ga)):O("",!0),M("span",ha,Z(E(X)),1),n.element.extra.icon!==""?(h(),w("span",Pa)):O("",!0)],4),n.element.extra.subText&&n.element.extra.subText.value?(h(),w("span",{key:0,style:ce(_.value?"visibility: hidden;":""),class:"sub-heading-group text-xs font-sans"},[M("span",ba,Z(E(Y)),1)],4)):O("",!0)],10,_a)):O("",!0),le.value?(h(),w("section",Sa,[de(i,{onExpired:t[1]||(t[1]=()=>B.value=""),onVerify:Et}),ie.value?(h(),w("p",Ia,Z(ie.value),1)):O("",!0)])):O("",!0),fe.value?O("",!0):tt((h(),w("button",{key:2,disabled:_.value||E(q)&&A.value,"data-animation-class":E(g),id:`${n.element.id}_btn`,style:ce(_.value||E(q)&&A.value?"cursor: default;":""),class:et([n.classStyles]),onClick:Tt,"aria-label":He()},[M("div",{style:ce(_.value||E(q)&&A.value?"visibility: hidden;":""),class:"main-heading-group"},[n.element.extra.icon!==""?(h(),w("div",Ea)):O("",!0),M("div",Oa,Z(E(X)),1),n.element.extra.icon!==""?(h(),w("div",Ta)):O("",!0)],4),n.element.extra.subText&&n.element.extra.subText.value?(h(),w("div",{key:0,style:ce(_.value||E(q)&&A.value?"visibility: hidden;":""),class:"text-xs font-sans"},[M("div",ka,Z(E(Y)),1)],4)):O("",!0),tt(M("div",xa,[de(ra,{loading:_.value||E(q)&&A.value,color:"rgb(255, 255, 255)",size:"30px"},null,8,["loading"])],512),[[at,_.value||E(q)&&A.value]])],14,wa)),[[at,!Te.value]]),M("div",null,[ze.value&&E(a).funnelPageId&&E(q)?(h(),w("section",Ra,[M("div",{id:`${n.element.id}-payment-form`,class:"payment-form"},[de(c,{id:`${n.element.id}-payment-element`,ref_key:"confirmPaymentRef",ref:qe,customProviderProps:ee.value,onPaymentCallback:It},null,8,["id","customProviderProps"]),G.value?(h(),w("div",Ca,[M("img",{src:E(ta),alt:"alert"},null,8,Na),At(" "+Z(G.value),1)])):O("",!0)],8,La)])):O("",!0)]),Te.value&&V.value?(h(),w("div",Ma,[E(St)?(h(),rt(d,{key:0,initiatePaypalPayment:Re,onApprovePaypalPayment:Le,onCancelPaypalPayment:Ce,paypalErrorMsg:W.value,processingPayment:P.value,currency:V.value},null,8,["paypalErrorMsg","processingPayment","currency"])):(h(),w("div",Aa,[de(s,{initiatePaypalPayment:Re,onApprovePaypalPayment:Le,onCancelPaypalPayment:Ce,processingPayment:P.value,currency:V.value},null,8,["processingPayment","currency"]),de(o,{initiatePaypalPayment:Re,onApprovePaypalPayment:Le,onCancelPaypalPayment:Ce,paypalErrorMsg:W.value,processingPayment:P.value,currency:V.value},null,8,["paypalErrorMsg","processingPayment","currency"])]))])):O("",!0),b.value?(h(),w("div",Da,Z(b.value),1)):O("",!0),xe.value?(h(),rt(v,{key:5,extra:r.element.extra,stripeOptions:z.value,order:m.value,traceId:m.value.traceId,element:r.element,styles:n.classStyles,onClosePaymentElementModal:Lt},null,8,["extra","stripeOptions","order","traceId","element","styles"])):O("",!0)],64)}}});export{tr as default};
