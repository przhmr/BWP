import{N as R,O as T,A,j as L}from"./entry.819ce933.js";import{u as U,w as _,x as P,s as D,y as b,z as I,A as O,B as N,C as W,D as F}from"./constants.8e39bf94.js";import{S as C}from"./HLConst.18ce99b8.js";function S(r){const u=r.split("/");return u.includes("v2")||u.includes("preview")}function Y(r,u){}function Z(r,u){var g,v;if(!((g=Object.keys(u??{}))!=null&&g.length))return r;const w=new URL(r);return(v=Object.keys(u))==null||v.forEach(p=>{w.searchParams.append(p,u[p])}),w==null?void 0:w.href}const ee=()=>{const r=U(),u=R(),w=T(),{$bus:g}=L();function v(){return window.location.search}function p(e){e&&(e=e.replace("tel:",""),window.location.href="tel://"+e)}function y(e){e&&(e=e.replace("sms:",""),window.location.href="sms://"+e)}function E(e){e&&(e=e.replace("mailto:",""),window.location.href="mailto:"+e)}function $(e,n){const t=`_mf_${e}`,o=JSON.stringify(n),a=A(t,{path:"/",maxAge:31536e3});a.value=o,_(t,o)}function k(e){const{extra:n}=e;r.value.videoExistsInPage&&g.$emit("handle-redirect"),n.action.value==="go-to-next-funnel-step"?c():n.action.value==="url"&&m(n.visitWebsite.value)}function c(e,n=!1,t){r.value.videoExistsInPage&&g.$emit("handle-redirect");try{const o=u.path.split("/"),a=r.value.funnelSteps||[],i=e?P({funnelSteps:a,stepId:e}):P({funnelSteps:a,funnelNextStep:r.value.funnelNextStep});let l=i==null?void 0:i.url;(o.includes("v2")||o.includes("preview"))&&(l=i?`/v2/preview/${i.id}`:""),t&&(l+=`/product/${t}`);const d=r.value.funnelDomain;if(window.location.hostname!=="localhost"&&!(o.includes("v2")||o.includes("preview"))&&d!==window.location.hostname){const s=`https://${d}${l}`+v();m({url:s,newTab:n})}else{if(n){const s=w.resolve({path:l});window.open(s.href+v(),"_blank");return}window.location.href=l+v();return}}catch(o){console.error(o)}}function m({url:e,newTab:n}){r.value.videoExistsInPage&&g.$emit("handle-redirect"),e=D(e);let t=r.value.locationId;const o=b(t);o&&(e=I(e,o)),n?window.open(e,"_blank")===null&&(window.location.href=e):window.location.href=e}const h=(e,n=!0)=>{try{const t=u.path.split("/"),o=r.value.funnelSteps||[],a=u.query,i=P({funnelSteps:o,stepId:e});if(i&&!i.id)return"#";if(t.includes("v2")||t.includes("preview"))return i?`/v2/preview/${i.id}`:"";let l=i==null?void 0:i.url;delete a.domain,delete a.page_url,delete a.additional_route,delete a.step_id,delete a.funnel_id,delete a.page_id;const d=r.value.funnelDomain,s=new URL(l,`https://${d}`);return n&&Object.keys(a).forEach(f=>{s.searchParams.append(f,a[f])}),O({url:s.href})}catch(t){return console.error(t),"#"}};return{call:p,sms:y,mailTo:E,createMembershipToken:$,goToNextFunnelStep:c,openUrl:m,getNextFunnelStepURL:h,redirectOnSubmit:k,goToEcomPrdouctListPage:()=>{var n;const e=(n=r.value.funnelSteps)==null?void 0:n.find(t=>(t==null?void 0:t.key)==="store-product-list");e&&c(e==null?void 0:e.value)},goToEcomCartPage:()=>{var n;const e=(n=r.value.funnelSteps)==null?void 0:n.find(t=>(t==null?void 0:t.key)==="store-cart");e&&c(e==null?void 0:e.value)},redirectAction:(e,n,t,o,a,i,l)=>{try{const{saleAction:d,stepPath:s,visitWebsite:f}=e;if(N(n.value.funnelId,t,l),W(n.value.funnelId),o.address){const x={name:o.fullName,addressLine1:o.address,city:o.city,state:o.state,zip:o.zipcode};F(n.value.funnelId,x)}if(!d)if(n.value.funnelNextStep){c();return}else throw new Error("Redirect not handled");switch(d.value){case"url":if(f&&f.value&&f.value.url){m(f.value);break}else throw new Error("Redirect not handled");case"step-path":if(s&&s.value){c(s.value);break}else throw new Error("Redirect not handled");case"go-to-next-funnel-step":if(n.value.funnelNextStep){c();break}else throw new Error("Redirect not handled")}}catch(d){if(console.error(d),a)alert(i);else{const s=JSON.parse(localStorage.getItem("_ud")||"{}"),f=[C.sepa].includes(localStorage.getItem(`pmt_${n.value.funnelId}_${s==null?void 0:s.id}`)||"")?"We are proccessing your order with the bank. We'll confirm you order after bank's confirmation.":`Order successfully placed! 
 However, Something went wrong while displaying this webpage, please contact the seller.`;alert(f)}}},getEcomProductListPageUrl:()=>{var n;const e=(n=r.value.funnelSteps)==null?void 0:n.find(t=>(t==null?void 0:t.key)==="store-product-list");return e?S(window.location.pathname)?`${window.location.origin}/v2/preview/${e==null?void 0:e.id}`:`https://${r.value.funnelDomain}${e.url}`:""},goToStep:(e,n,t)=>{if(v()){e==null||e.preventDefault();const a=h(n,!0);t?window.open(a,"_blank")===null&&(window.location.href=a):window.location.href=a}},goToEcomCheckoutPage:()=>{var n;const e=(n=r.value.funnelSteps)==null?void 0:n.find(t=>(t==null?void 0:t.key)==="store-checkout");e&&c(e==null?void 0:e.value)},getEcomProductListPagePath:e=>{var o;const n=(o=r.value.funnelSteps)==null?void 0:o.find(a=>(a==null?void 0:a.key)==="store-product-list");if(!n)return"";let t="";return S(u.path)?t=`/v2/preview/${n==null?void 0:n.id}`:t=`https://${r.value.funnelDomain}${n.url}`,e&&(t+=`/collections/${e}`),t},goToEcomPrdouctDetailPage:e=>{var t;const n=(t=r.value.funnelSteps)==null?void 0:t.find(o=>(o==null?void 0:o.key)==="store-product-detail");n&&c(n==null?void 0:n.value,!1,e)},getRedirectActionUrl:e=>{var a;const{saleAction:n,stepPath:t,visitWebsite:o}=e;if(!n)return r.value.funnelNextStep?h():"";switch(n.value){case"url":return((a=o==null?void 0:o.value)==null?void 0:a.url)??"";case"step-path":return t!=null&&t.value?h(t.value):"";case"go-to-next-funnel-step":{const i=r.value.funnelSteps||[],l=P({funnelSteps:i,funnelNextStep:r.value.funnelNextStep});return r.value.funnelNextStep&&(l!=null&&l.value)?h(l.value):""}default:return""}}}};export{Z as a,Y as g,S as i,ee as u};
